## Промышленность

Чтобы оптимизировать производственные расходы, металлургический комбинат «Стальная птица» решил уменьшить потребление электроэнергии на этапе обработки стали. Для этого комбинату нужно контролировать температуру сплава. Ваша задача — построить модель, которая будет её предсказывать. Заказчик хочет использовать разработанную модель для имитации технологического процесса. Изучите его, прежде чем генерировать новые признаки.

## Описание процесса обработки

Сталь обрабатывают в металлическом ковше вместимостью около 100 тонн. Чтобы ковш выдерживал высокие температуры, изнутри его облицовывают огнеупорным кирпичом. Расплавленную сталь заливают в ковш и подогревают до нужной температуры графитовыми электродами. Они установлены на крышке ковша.

Сначала происходит десульфурация — из стали выводят серу и корректируют её химический состав добавлением примесей. Затем сталь легируют — добавляют в неё куски сплава из бункера для сыпучих материалов или порошковую проволоку через специальный трайб-аппарат.

Прежде чем в первый раз ввести легирующие добавки, специалисты производят химический анализ стали и измеряют её температуру. Потом температуру на несколько минут повышают, уже после этого добавляют легирующие материалы и продувают сталь инертным газом, чтобы перемешать, а затем снова проводят измерения. Такой цикл повторяется до тех пор, пока не будут достигнуты нужный химический состав стали и оптимальная температура плавки.

Дальше расплавленная сталь отправляется на доводку металла или поступает в машину непрерывной разливки. Оттуда готовый продукт выходит в виде заготовок-слябов (англ. slab, «плита»).

## Описание данных

Данные хранятся в базе данных PostgreSQL. Она состоит из нескольких таблиц:
- `steel.data_arc` — данные об электродах;
- `steel.data_bulk` — данные об объёме сыпучих материалов;
- `steel.data_bulk_time` — данные о времени подачи сыпучих материалов;
- `steel.data_gas` — данные о продувке сплава газом;
- `steel.data_temp` — данные об измерениях температуры;
- `steel.data_wire` — данные об объёме проволочных материалов;
- `steel.data_wire_time` — данные о времени подачи проволочных материалов.

**Таблица `steel.data_arc`**
- `key` — номер партии;
- `BeginHeat` — время начала нагрева;
- `EndHeat` — время окончания нагрева;
- `ActivePower` — значение активной мощности;
- `ReactivePower` — значение реактивной мощности.

**Таблица `steel.data_bulk`**
- `key` — номер партии;
- `Bulk1` … `Bulk15` — объём подаваемого материала.

**Таблица `steel.data_bulk_time`**
- `key` — номер партии;
- `Bulk1` … `Bulk15` — время подачи материала.

**Таблица `steel.data_gas`**
- `key` — номер партии;
- `gas` — объём подаваемого газа.

**Таблица `steel.data_temp`**
- `key` — номер партии;
- `MesaureTime` — время замера;
- `Temperature` — значение температуры.

**Таблица `steel.data_wire`**
- `key` — номер партии;
- `Wire1` … `Wire15` — объём подаваемых проволочных материалов.

**Таблица `steel.data_wire_time`**
- `key` — номер партии;
- `Wire1` … `Wire15` — время подачи проволочных материалов.

Во всех файлах столбец `key` содержит номер партии. В таблицах может быть несколько строк с одинаковым значением `key`: они соответствуют разным итерациям обработки.

## Использованные инструменты

- python
- numpy
- pandas
- datetime
- datetime.timedelta
- lightgbm.LGBMRegressor
- matplotlib.pyplot
- random
- seaborn
- sklearn.dummy.DummyRegressor
- sklearn.ensemble.RandomForestRegressor
- sklearn.linear_model.Lasso
- sklearn.metrics.mean_absolute_error
- sklearn.model_selection.KFold
- sklearn.model_selection.RandomizedSearchCV
- sklearn.model_selection.train_test_split
- sklearn.preprocessing.StandardScaler
- sqlalchemy.create_engine
- torch
- torch.nn
- torch.optim.Adam
- torch.utils.data.DataLoader
- torch.utils.data.Dataset
- torch.utils.data.TensorDataset
- tqdm
- xgboost.XGBRegressor

## Результат

Перед нами была поставлена задача - разработать модель, которая предскажет температуру сплава, что способствует уменьшению потребления энергии на этапе обработки стали.

Нам были предоставлены данные - семь таблиц с данными, которые фиксировались при обработке стали. 

Каждая таблица была изучена и предобработана. Обрабатывались пропуски и аномалии, создавались новые признаки, удалялись ненужные, удалялись строки с неполными данными. В результате все таблицы были сведены в одну. Получилась таблица с 2325 строками и 35 признаками. Данные были разделены на целевой признак `finish_temperature` - последняя температура партии, и обучающие признаки. Разделили данные на тренировочную и тестовую выборки.

Для обучения были выбраны пять моделей - Lasso Regression, Random Forest, LightGBM, XGBoost, Полносвязная нейронная сеть. Для каждой модели были подобраны гиперпараметры с помощью RandomizedSearchCV, модели были обучены и получены предсказания. 

Все модели показали допустимую метрику MAE - от 5.86 до 6.17. Лучшую метрику показала модель LightGBM - MAE 5.86. Она была выбрана для тестирования.

Модель была успешна протестирована - получены предсказания на тестовых данных, MAE составила 6.23, что меньше максимально допустимой 6.8.

Для улучшения модели можно рассмотреть подбор других гиперпараметров, более углублённо поработать с признаками - какие-то возможно удалить, а также сгенерировать новые признаки.

Заказчику можно посоветовать более точно собирать данные, чтобы исключить выбросы и улучшить статистику. Возможно добавить для исследования ещё какие-то данные, которые до сих пор не учитывались.

В целом можно заключить, что проделанная нами работа достигла поставлееных задач. Модель может эффективно использоваться заказчиком для уменьшения электропотребления.