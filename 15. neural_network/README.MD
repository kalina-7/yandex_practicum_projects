## Прогнозирование температуры звезды

Пришла задача от обсерватории «Небо на ладони»: придумать, как с помощью нейросети определять температуру на поверхности обнаруженных звёзд. Обычно для расчёта температуры учёные пользуются следующими методами:
- Закон смещения Вина.
- Закон Стефана-Больцмана.
- Спектральный анализ.
Каждый из них имеет плюсы и минусы. Обсерватория хочет внедрить технологии машинного обучения для предсказания температуры звёзд, надеясь, что этот метод будет наиболее точным и удобным.

В базе обсерватории есть характеристики уже изученных 240 звёзд.

Для выполнения задачи нам необходимо разработать нейронную сеть, которая поможет предсказывать абсолютную температуру на поверхности звезды.

## Алгоритм решения задачи

***Шаг 1. Загрузка исходных данных из файла***
`/datasets/6_class.csv `

***Шаг 2. Исследовательский анализ***
Исследовательский анализ:
- количественных данных,
- категориальных данных.
Использовать графический анализ и сделать вывод.

***Шаг 3. Подготовка данных к построению модели***
1. По результату исследовательского анализа внести корректировки, если они нужны. Сделать вывод.
2. Если необходимо, категоризировать исходные данные.
3. Подготовить обучающую и тестовую выборки.
4. Провести масштабирование количественных данных.

***Шаг 4. Построение простой модели нейронной сети — baseline***
1. Создать класс для задания архитектуры нейронной сети.
2. Самостоятельно выберать количество скрытых слоёв, количество нейронов на них, функции активации на скрытых и выходном слоях. Попробовать и сравнить несколько подобных комбинаций.
3. Провести обучение нейронной сети:
- Создать функцию для обучения нейронной сети.
- Провести обучение модели.
- Построить график «Факт — Прогноз», где по горизонтальной оси будут отложены условные номера звёзд, а по вертикальной — температура в Кельвинах.
- Сделать вывод.

***Шаг 5. Улучшение сети***
- Создать решение с перебором параметров нейросети. Список параметров для перебора должен включать как минимум «dropout» и «размер батча». Архитектуру нейронной сети: количество слоёв, нейронов, вид функции активации — оставить как в Baseline, чтобы сравнить результат.
- Провести обучение нейронной сети. Вывести метрику RMSE и график «Факт — прогноз». Метрика RMSE не должна превышать 4500.
- Сделать вывод. Желательно оформить его в виде таблицы или графика.

***Шаг 6. Выводы по проекту***
- Кратко описать результаты каждого типа модели.
- Написать выводы сравнения двух моделей.

## Характеристики
- Относительная светимость `L/Lo` — светимость звезды относительно Солнца.
- Относительный радиус `R/Ro` — радиус звезды относительно радиуса Солнца.
- Абсолютная звёздная величина `Mv` — физическая величина, характеризующая блеск звезды.
- Звёздный цвет (`white`, `red`, `blue`, `yellow`, `yellow-orange` и др.) — цвет звезды, который определяют на основе спектрального анализа.
- Тип звезды.

| Тип звезды                        | Номер, соответствующий типу |
|:--------------------------------- |:---------------------------:|
| Коричневый карлик	                | 0                           |
| Красный карлик	                | 1                           |
| Белый карлик	                    | 2                           |
| Звёзды главной последовательности	| 3                           |
| Сверхгигант                       | 4                           |
| Гипергигант                       | 5                           |

- Абсолютная температура `T(K)` — температура на поверхности звезды в Кельвинах.

## Использованные инструменты
- python
- numpy
- pandas
- matplotlib.pyplot
- seaborn
- sklearn.compose.ColumnTransformer
- sklearn.metrics.make_scorer
- sklearn.metrics.mean_squared_error
- sklearn.model_selection.RandomizedSearchCV
- sklearn.model_selection.train_test_split
- sklearn.preprocessing.OneHotEncoder
- sklearn.preprocessing.StandardScaler
- skorch.NeuralNetRegressor
- skorch.callbacks.EpochScoring
- skorch.callbacks.EarlyStopping
- skorch.dataset.ValidSplit
- torch
- torch.nn
- torchvision
- torchvision.transforms
- torch.utils.data.Dataset
- torch.utils.data.DataLoader

## Результат

После изучения данных провели их предобработку - проверили на дубликаты, привели названия столбцов к стандарту PEP8, объединили неявные дубликаты в столбце `star_color` к единому виду. Проверили анализ каждого признака, аномалий в данных не обнаружено.

Подготовили данные для обучения - разбили на трентровочную и тестовую выборки, масштабировали числовые и закодировали категориальные признаки.

Построили базовую нейронную сеть, подобрали для нее оптимальные параметры. Обучили нейросеть на тренировочной выборке и получили предсказания на тестовой выборке. Получили метрику качества RMSE 4771, что выше заданного значения метрики RMSE 4500. 

Для улучшения модели подобрали оптимайзер, лучшим оказался Adam c гиперпараметром lr 0.01. Подобрали методы регуляризации dropout и BatchNorm. Заново обучили нейросеть и получили на тренировочной выборке предсказания на тестовой выборке. Метрика RMSE значительно улучшилась, показав значение 4025. 

Для наглядного результата работы метрики построили графики "Факт-прогноз" и "Потери нейросети", из которых видно, что модель действительно стала давать более точные предсказания, и что модель хорощо обучается, без недо- и переобучений.

По итогам проведённой работы для улучшения результатов можно дать заказчику следующие рекомендации рекомендации - использовать более качественные данные, увеличить размер датасета, попробовать разные модели обучения, не ограничиваясь нейросетью.
