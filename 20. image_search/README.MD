## Поиск изображений по запросу

Нам поручено разработать демонстрационную версию поиска изображений по запросу.

Для демонстрационной версии нужно обучить модель, которая получит векторное представление изображения, векторное представление текста, а на выходе выдаст число от 0 до 1 — покажет, насколько текст и картинка подходят друг другу.

## Описание данных

Данные лежат в папке `/datasets/image_search/`.

В файле `train_dataset.csv` находится информация, необходимая для обучения: имя файла изображения, идентификатор описания и текст описания. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат `<имя файла изображения>#<порядковый номер описания>`.

В папке `train_images` содержатся изображения для тренировки модели.

В файле `CrowdAnnotations.tsv` — данные по соответствию изображения и описания, полученные с помощью краудсорсинга. Номера колонок и соответствующий тип данных:

1. Имя файла изображения.
2. Идентификатор описания.
3. Доля людей, подтвердивших, что описание соответствует изображению.
4. Количество человек, подтвердивших, что описание соответствует изображению.
5. Количество человек, подтвердивших, что описание не соответствует изображению.

В файле `ExpertAnnotations.tsv` содержатся данные по соответствию изображения и описания, полученные в результате опроса экспертов. Номера колонок и соответствующий тип данных:

1. Имя файла изображения.
2. Идентификатор описания.

3, 4, 5 — оценки трёх экспертов.

Эксперты ставят оценки по шкале от 1 до 4, где 1 — изображение и запрос совершенно не соответствуют друг другу, 2 — запрос содержит элементы описания изображения, но в целом запрос тексту не соответствует, 3 — запрос и текст соответствуют с точностью до некоторых деталей, 4 — запрос и текст соответствуют полностью.

В файле `test_queries.csv` находится информация, необходимая для тестирования: идентификатор запроса, текст запроса и релевантное изображение. Для одной картинки может быть доступно до 5 описаний. Идентификатор описания имеет формат `<имя файла изображения>#<порядковый номер описания>`.

В папке `test_images` содержатся изображения для тестирования модели.

## Использованные инструменты

- os
- os.path.join
- python
- numpy
- pandas
- math.ceil
- matplotlib.pyplot
- PIL.Image
- random
- sklearn.linear_model
- sklearn.dummy.DummyRegressor
- sklearn.feature_extraction.text.TfidfVectorizer
- sklearn.metrics.mean_squared_error
- sklearn.model_selection.GroupShuffleSplit
- sklearn.preprocessing.MinMaxScaler
- sklearn.preprocessing.StandardScaler
- spacy
- tensorflow 
- tensorflow.keras.layers.Flatten
- tensorflow.keras.models.Sequential
- torch
- torch.nn
- torchvision
- torchvision.models
- torchvision.transforms

## Результат

По предоставленным данным мной была проделана следующая работа:
 - были загружены необходимые библиотеки, выгружены и обработаны данные - изображения, их описания, оценки экспертов и других людей;
 - на основе этих данных были получены дополнительные признаки - общая оценка, принадлежность к запрещенному контенту;
 - векторизованы изображения;
 - векторизованы тексты;
 - векторы были объединены, получены 1422 новых признаков;
 - в качестве основной выбрали метрику RMSE;
 - данные разбиты на тренировочную и тестовую выборки;
 - были обучены две модели - линейная модель с регуляризацией Lasso Regression и полносвязная нейронная сеть;
 - по итогам обучения наилучшую метрику RMSE - 0.212 показала нейронная сеть, она и была выбрана для проверки на тестовых данных;
 - проведено тестирование модели, которое показало, что модель работает, но требуются дополнительные действия, например, увеличение тренировочных данных, для улучшения результата.
 
В итоге можно сделать вывод, что все выбранные инструменты и методы работают хорошо. Модель показывает определённый результат. Однако для более качественного результата при выборе изображения по запросу нужны более качественные данные, а набор данных должен быть гораздо больше. 